Function GetValuesFromRow(rowIndex As Long, colStart As Long, colEnd As Long) As Variant
    Dim arr() As Variant
    Dim i As Long
    Dim count As Long

    count = 0
    For i = colStart To colEnd
        If Not IsEmpty(Cells(rowIndex, i).Value) Then
            count = count + 1
            ReDim Preserve arr(1 To count)
            arr(count) = Cells(rowIndex, i).Value
        End If
    Next i

    If count > 0 Then
        GetValuesFromRow = arr
    Else
        GetValuesFromRow = Array() ' Trả về mảng rỗng nếu không có giá trị
    End If
End Function
