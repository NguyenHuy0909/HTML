Sub GetValuesFromA1ToA10_Safe()
    Dim arr() As Variant
    Dim i As Integer
    Dim count As Integer

    count = 0
    ' Duyệt từ A1 đến A10
    For i = 1 To 10
        If Not IsEmpty(Range("A" & i).Value) Then
            count = count + 1
            ReDim Preserve arr(1 To count)
            arr(count) = Range("A" & i).Value
        End If
    Next i

    ' In ra kết quả
    For i = 1 To count
        Debug.Print arr(i)
    Next i
End Sub
