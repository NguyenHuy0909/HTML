Sub SafeGetRangeA1ToA10()
    Dim arrRaw As Variant
    Dim arrFinal As Variant
    Dim i As Integer

    ' Lấy dữ liệu từ A1:A10
    arrRaw = Range("A1:A10").Value

    ' Kiểm tra xem có phải mảng 2 chiều không
    If IsArray(arrRaw) Then
        ' Chuyển thành mảng 1 chiều
        arrFinal = Application.WorksheetFunction.Transpose(arrRaw)

        ' In ra từng phần tử
        For i = LBound(arrFinal) To UBound(arrFinal)
            Debug.Print arrFinal(i)
        Next i
    Else
        MsgBox "Không có dữ liệu hoặc chỉ có một ô có giá trị."
    End If
End Sub
