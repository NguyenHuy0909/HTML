Public Sub SetLineType(i As Long, dashStyle As Long)

    LineDash(i) = dashStyle

    ' cập nhật caption
    Me.Controls("lblLine" & i).Caption = DashStyleToText(dashStyle)

    ' lưu vào Workbook
    SaveLineType i, dashStyle

End Sub
Private Function DashStyleToText(d As Long) As String
    Select Case d
        Case msoLineSolid: DashStyleToText = "Solid"
        Case msoLineDash: DashStyleToText = "Dash"
        Case msoLineRoundDot: DashStyleToText = "Dot"
        Case msoLineDashDot: DashStyleToText = "Dash Dot"
        Case msoLineDashDotDot: DashStyleToText = "Dash Dot Dot"
        Case msoLineLongDash: DashStyleToText = "Long Dash"
        Case msoLineLongDashDot: DashStyleToText = "Long Dash Dot"
        Case msoLineLongDashDotDot: DashStyleToText = "Long Dash Dot Dot"
        Case Else: DashStyleToText = "Custom"
    End Select
End Function
Public Sub SaveLineType(i As Long, dashStyle As Long)
    Dim nm As String
    nm = "LineType_" & i

    On Error Resume Next
    ThisWorkbook.Names(nm).Delete
    On Error GoTo 0

    ThisWorkbook.Names.Add Name:=nm, RefersTo:=dashStyle
End Sub
Dim i As Long, v As Variant

For i = 1 To 4
    On Error Resume Next
    v = Evaluate(ThisWorkbook.Names("LineType_" & i).RefersTo)
    On Error GoTo 0

    If v <> 0 Then
        LineDash(i) = v
        Me.Controls("lblLine" & i).Caption = DashStyleToText(v)
    End If
Next i
