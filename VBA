Public Function GetArrayFromSheet(ByVal groupName As String) As Variant

    Dim ws As Worksheet
    Dim lastCol As Long
    Dim rng As Range
    
    Set ws = ThisWorkbook.Sheets("Config")
    
    ' Tìm dòng chứa groupName
    Dim foundCell As Range
    Set foundCell = ws.Columns(1).Find(groupName, LookAt:=xlWhole)
    
    If foundCell Is Nothing Then
        MsgBox "Không tìm thấy group: " & groupName
        Exit Function
    End If
    
    lastCol = ws.Cells(foundCell.Row, ws.Columns.Count).End(xlToLeft).Column
    
    Set rng = ws.Range(ws.Cells(foundCell.Row, 2), ws.Cells(foundCell.Row, lastCol))
    
    GetArrayFromSheet = Application.Transpose(Application.Transpose(rng.Value))

End Function
